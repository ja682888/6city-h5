/*!  v 0.0.1  | (c) Tue Sep 19 2017 13:54:07 GMT+0800 (中国标准时间)  Julian  | https://github.com/zanjs/6city-h5#readme  app */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.LazyLoadImg=e()}(this,function(){"use strict";var t=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.getBoundingClientRect(),n=t.offsetWidth,o=t.offsetHeight,r=window.innerWidth,a=window.innerHeight,s=!(i.right-e.left<=0&&i.left+n-e.left<=0||i.left+e.right>=r&&i.right+e.right>=n+r),c=!(i.bottom-e.top<=0&&i.top+o-e.top<=0||i.top+e.bottom>=a&&i.bottom+e.bottom>=o+a);return 0!==t.width&&0!==t.height&&s&&c},e=document.createElement("canvas");e.getContext("2d").globalAlpha=0;var i={},n=function(t,n,o){if(i[t])return i[t];e.width=n,e.height=o;var r=e.toDataURL("image/png");return i[t]=r,r},o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},s=window,c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.options={el:document.querySelector("body"),mode:"default",time:300,done:!0,diy:{backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center center"},position:{top:0,right:0,bottom:0,left:0},before:function(t){},success:function(t){},error:function(t){}},t.position=a({},this.options.position,t.position),t.diy=a({},this.options.diy,t.diy),a(this.options,t),this.start()}return r(e,[{key:"start",value:function(){this._timer=!0,this._start()}},{key:"_start",value:function(){var e=this,i=this.options;clearTimeout(this._timer),this._timer&&(this._timer=setTimeout(function(){var n=Array.prototype.slice.apply(i.el.querySelectorAll("[data-src]"));return!n.length&&i.done?clearTimeout(e._timer):(n.forEach(function(n){!n.dataset.LazyLoadImgState&&t(n,i.position)&&e.loadImg(n)}),void e._start())},i.time))}},{key:"loadImg",value:function(t){var e=this,i=this.options;t.dataset.LazyLoadImgState="start",i.before.call(this,t);var o=new s.Image;o.src=t.dataset.src,o.addEventListener("load",function(){return"diy"===i.mode?(t.src=n(t.src,t.width,t.height),i.diy.backgroundImage="url("+o.src+")",a(t.style,i.diy)):t.src=o.src,delete t.dataset.src,delete t.dataset.LazyLoadImgState,i.success.call(e,t)},!1),o.addEventListener("error",function(){delete t.dataset.src,delete t.dataset.LazyLoadImgState,i.error.call(e,t)},!1)}},{key:"destroy",value:function(){delete this._timer}}]),e}();return c}),!function(t,e){function i(){var e=r.getBoundingClientRect().width;e/c>750&&(e=750*c);var i=e/10;r.style.fontSize=i+"px",l.rem=t.rem=i}var n,o=t.document,r=o.documentElement,a=o.querySelector('meta[name="viewport"]'),s=o.querySelector('meta[name="flexible"]'),c=0,d=0,l=e.flexible||(e.flexible={});if(a){console.warn("将根据已有的meta标签来设置缩放比例");var u=a.getAttribute("content").match(/initial\-scale=([\d\.]+)/);u&&(d=parseFloat(u[1]),c=parseInt(1/d))}else if(s){var m=s.getAttribute("content");if(m){var f=m.match(/initial\-dpr=([\d\.]+)/),p=m.match(/maximum\-dpr=([\d\.]+)/);f&&(c=parseFloat(f[1]),d=parseFloat((1/c).toFixed(2))),p&&(c=parseFloat(p[1]),d=parseFloat((1/c).toFixed(2)))}}if(!c&&!d){var h=t.navigator.userAgent,g=(!!h.match(/android/gi),!!h.match(/iphone/gi)),y=g&&!!h.match(/OS 9_3/),v=t.devicePixelRatio;c=g&&!y?v>=3&&(!c||c>=3)?3:v>=2&&(!c||c>=2)?2:1:1,d=1/c}if(r.setAttribute("data-dpr",c),!a)if(a=o.createElement("meta"),a.setAttribute("name","viewport"),a.setAttribute("content","initial-scale="+d+", maximum-scale="+d+", minimum-scale="+d+", user-scalable=no"),r.firstElementChild)r.firstElementChild.appendChild(a);else{var b=o.createElement("div");b.appendChild(a),o.write(b.innerHTML)}t.addEventListener("resize",function(){clearTimeout(n),n=setTimeout(i,300)},!1),t.addEventListener("pageshow",function(t){t.persisted&&(clearTimeout(n),n=setTimeout(i,300))},!1),"complete"===o.readyState?o.body.style.fontSize=12*c+"px":o.addEventListener("DOMContentLoaded",function(){o.body.style.fontSize=12*c+"px"},!1),i(),l.dpr=t.dpr=c,l.refreshRem=i,l.rem2px=function(t){var e=parseFloat(t)*this.rem;return"string"==typeof t&&t.match(/rem$/)&&(e+="px"),e},l.px2rem=function(t){var e=parseFloat(t)/this.rem;return"string"==typeof t&&t.match(/px$/)&&(e+="rem"),e}}(window,window.lib||(window.lib={})),function(){window.onload=function(){new LazyLoadImg({el:document.querySelector("#app"),mode:"default",time:300,complete:!0,position:{top:0,right:0,bottom:0,left:0},before:function(){},success:function(t){t.classList.add("loading-success")},error:function(t){t.src="./images/error.png"}})}}();